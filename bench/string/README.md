# String formatting

Benchmark of the libfly string formatter against the popular {fmt} library and the STL:

* [libfly](/fly/types/string/string.hpp)
* [{fmt}](https://github.com/fmtlib/fmt)

## Results

All results below are the median of 1000001 iterations of creating a formatted string.

### Formatting with floats

| Formatter         | Duration (ns) |
| :--               |           --: |
| libfly            |         0.381 |
| {fmt}             |         0.261 |
| std::stringstream |         0.761 |

### Formatting without floats

| Formatter         | Duration (ns) |
| :--               |           --: |
| libfly            |         0.300 |
| {fmt}             |         0.170 |
| std::stringstream |         0.390 |


## Profiles

### Formatting with floats

```
Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  ms/call  ms/call  name
 20.59      0.16     0.07  1000001     0.00     0.00  void fly::string::detail::format_to<char, std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, double, int, double, char const (&) [4], decltype(nullptr), char>(std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, fly::string::detail::BasicFormatString<char, std::type_identity<double>::type, std::type_identity<int>::type, std::type_identity<double>::type, std::type_identity<char const (&) [4]>::type, std::type_identity<decltype(nullptr)>::type, std::type_identity<char>::type>&&, double&&, int&&, double&&, char const (&) [4], decltype(nullptr)&&, char&&)
 11.76      0.20     0.04  2000003     0.00     0.00  fly::string::Formatter<double, char>::format<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(double, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)::{lambda()#3}::operator()() const
 11.76      0.24     0.04  1000001     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, decltype(nullptr)>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  8.82      0.27     0.03  2000003     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, double>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  5.88      0.29     0.02 20000244     0.00     0.00  std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::push_back(char)
  2.94      0.32     0.01  1000018     0.00     0.00  void fly::string::Formatter<unsigned long, char>::format<unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned long, bool, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&) [clone .constprop.0]
  2.94      0.33     0.01  1000007     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, char>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  2.94      0.34     0.01  1000001     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, int>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  0.00      0.34     0.00  1000006     0.00     0.00  void fly::string::detail::format_string_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, char>(void const*, unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  0.00      0.34     0.00  1000006     0.00     0.00  void fly::string::Formatter<std::basic_string_view<char, std::char_traits<char> >, char>::format<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(std::basic_string_view<char, std::char_traits<char> > const&, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  0.00      0.34     0.00  1000001     0.00     0.00  void fly::string::Formatter<int, char>::append_number<unsigned int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned int, int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  0.00      0.34     0.00  1000001     0.00     0.00  void fly::string::Formatter<unsigned long, char>::append_number<unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned long, int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  0.00      0.34     0.00       54     0.00     0.00  void std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >::_M_realloc_insert<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&>(__gnu_cxx::__normal_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
  0.00      0.34     0.00       50     0.00     0.00  std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >::push_back(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
  0.00      0.34     0.00       35     0.00     0.00  std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
  0.00      0.34     0.00       21     0.00     0.00  std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
```

### Formatting without floats

```
Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls  ms/call  ms/call  name
 35.29      0.12     0.12 33000257     0.00     0.00  std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::push_back(char)
 14.71      0.25     0.05  3000003     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, int>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  8.82      0.28     0.03  1000001     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, decltype(nullptr)>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  5.88      0.30     0.02  1000001     0.00     0.00  void fly::string::detail::format_to<char, std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, int, int, int, char const (&) [4], decltype(nullptr), char>(std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, fly::string::detail::BasicFormatString<char, std::type_identity<int>::type, std::type_identity<int>::type, std::type_identity<int>::type, std::type_identity<char const (&) [4]>::type, std::type_identity<decltype(nullptr)>::type, std::type_identity<char>::type>&&, int&&, int&&, int&&, char const (&) [4], decltype(nullptr)&&, char&&)
  2.94      0.33     0.01  3000003     0.00     0.00  void fly::string::Formatter<int, char>::append_number<unsigned int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned int, int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  2.94      0.34     0.01  1000006     0.00     0.00  void fly::string::Formatter<std::basic_string_view<char, std::char_traits<char> >, char>::format<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(std::basic_string_view<char, std::char_traits<char> > const&, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  0.00      0.34     0.00  1000018     0.00     0.00  void fly::string::Formatter<unsigned long, char>::format<unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned long, bool, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&) [clone .constprop.0]
  0.00      0.34     0.00  1000007     0.00     0.00  void fly::string::detail::format_standard_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, char>(fly::string::detail::StandardValue<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  0.00      0.34     0.00  1000006     0.00     0.00  void fly::string::detail::format_string_value<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>, char>(void const*, unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&, fly::string::detail::BasicFormatSpecifier<fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>::char_type>&&)
  0.00      0.34     0.00  1000001     0.00     0.00  void fly::string::Formatter<unsigned long, char>::append_number<unsigned long, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char> >(unsigned long, int, fly::string::detail::BasicFormatContext<std::back_insert_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, char>&)
  0.00      0.34     0.00       54     0.00     0.00  void std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >::_M_realloc_insert<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&>(__gnu_cxx::__normal_iterator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*, std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
  0.00      0.34     0.00       50     0.00     0.00  std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >::push_back(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)
```
